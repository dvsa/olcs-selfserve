<div class="page-header">
  <?php echo $this->navigation('navigation')->breadcrumbs()->setPartial('partials/breadcrumbs'); ?>

  <div class="page-header__wrapper">
    <?php
    switch ($this->lva) {
      case "licence":
        ?>
        <h3 class="page-header__subtitle">
          <?php echo !empty($licNo) ? $this->escapeHtml($licNo) : ''; ?>
        </h3>
        <?php
        break;

      case "application":
        if ((int)$this->stepX > 0):
          ?>
          <h3 class="page-header__subtitle">
          <?php
          echo (
            (int)$this->stepY > 0
            ? sprintf($this->translate('application.steps'), $this->stepX, $this->stepY)
            : sprintf($this->translate('application.step'), $this->stepX)
          );
          ?>
          </h3>
        <?php
        endif;
        break;

      case "variation":
        if (!empty($this->reference)) : ?>
          <h3 class="page-header__subtitle">
            <?php echo $this->escapeHtml($this->reference); ?>
          </h3>
        <?php
        endif;
        break;
      
      default:
        break;
    }
    ?>
    <h1 class="js-title"><?php echo $this->translate($title); ?></h1>
  </div>
</div><!-- page-header-->

<div class="row">

  <?php if (isset($filterForm)): ?>

  <div class="one-quarter sidebar--plain">
    <h4>Filter by:</h4>
    <?php echo $this->form($filterForm); ?>
    <?php
    $statusTranslated = $this->translate($this->status);
    /** @var  \Common\Service\Helper\TranslationHelperService $translator */
    $translator = $this->getHelperPluginManager()->getServiceLocator()->get('Helper\Translation');

    if ($this->lva === 'application') {
      echo $translator->translateReplace(
          'markup-application-right-column', [$this->escapeHtml($reference), $statusTranslated]
      );
    } elseif ($this->lva === 'variation') {
      echo $translator->translateReplace(
          'markup-variation-right-column', [$this->escapeHtml($reference), $statusTranslated]
      );
    } elseif ($this->lva === 'licence') {
      echo $translator->translateReplace(
          'markup-licence-right-column',
          [
              $this->escapeHtml($this->licNo),
              $statusTranslated,
              ($this->renewalDate ? strftime("%d %B %G",strtotime($this->renewalDate)) : ''),
              ($this->startDate ? strftime("%d %B %G",strtotime($this->startDate)) : ''),
          ]
      );
    }
    ?>
  </div>

  <div class="three-quarters lva-details">

    <div class="js-body">

    <?php else : ?>

  <div class="two-thirds lva-details">

    <div class="js-body">

    <?php endif; ?>

      <?php
        $guidanceMessage = $this->placeholder('guidance');
        if (!empty($guidanceMessage)) {
          foreach ($guidanceMessage as $message):
      ?>

      <div class="guidance">
        <p><?php echo $this->translate($message); ?></p>
      </div>

      <?php endforeach; }
        if (isset($sectionText)) {
      ?>

      <?php echo $this->translate($sectionText); ?>

      <?php } ?>

      <?php

        $messages = $this->flashMessengerAll('norender')->getMessagesFromNamespace('prominent-error');

        foreach ($messages as $message) {
            ?>
            <div class="validation-summary">
                <?php echo $this->translate($message); ?>
            </div>
            <?php
        }

        echo $this->flashMessengerAll();

        if (isset($searchForm)) {
            $searchForm->prepare();
            echo $this->formErrors($searchForm);
            echo $this->form($searchForm);
        }

        if (isset($table)) {
          echo $table;
        }

        if (isset($form)) {
          $form->prepare();
          echo $this->formErrors($form);
          echo $this->form($form);
        }
      ?>

      </div> <!-- /js-body -->
    </div>

</div>
